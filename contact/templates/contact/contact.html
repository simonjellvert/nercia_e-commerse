{% extends "base.html" %}
{% load static %}

{% block extra_title %}Contact{% endblock %}

{% block content %}
<div class="container-fluid mb-5">
    <div class="row">
        <div class="col-12 p-0">
            <img src="{% static 'img/background_img/background_products.png' %}" alt="Skydiver falling from the air"
                class="background-products mb-5">
        </div>
    </div>
    <div class="row">
        <div class="col-12 mb-3 mt-5 d-flex flex-column align-items-center text-center">
            <h1 class="mb-3">
                Where to find us?
            </h1>
            <p class="products-header-p">
                If you want to get in touch with one of our project managers to ask questions about a specific training, what trainings your employees needs develop in their roles or if you want career advise for yourself we suggest you call one of our project managers from the list below. <br>
                Our project managers have years of experience of matching trainings to a companies needs.
            </p>
            <p class="products-header-p mb-3">
                Give us a call or book a meeting and we will guide you!
            </p>
            {% if request.user.is_authenticated %}
                {% if request.user.is_superuser %}
                    <button type="button" class="btn btn-primary rounded-0" data-toggle="modal" data-target="#addContactModal">Add contact</button>
                {% endif %}
            {% endif %}
        </div>
    </div>
</div>
<div class="container-fluid mx-auto d-flex justify-content-center align-items-center">
    <div class="row">
        <div class="col-12 col-sm-4">
            {% for contact in contacts %}
                <div class="card rounded-0">
                    <img class="contact-img" src="{{ contact.image.url }}" alt="{{ contact.name }}">
                    <div class="card-body">
                        <h5>{{ contact.name }}</h5>
                        <div class="row">
                            <i class="fa-solid fa-phone"><p>{{ contact.phone_number }}</p></i>
                        </div>
                        <div class="row">
                            <i class="fa-solid fa-envelope mr-1"></i>
                            <p>{{ contact.email }}</p>
                        </div>
                        {% if request.user.is_authenticated %}
                            {% if request.user.is_superuser %}
                                <div>
                                    <a href="#" class="text-primary" data-toggle="modal" data-target="#editContactModal" data-contact-id="{{ contact.id }}">Edit</button>
                                    <a href="#" class="text-danger" data-toggle="modal" data-target="#deleteContactModal" data-contact-id="{{ contact.id }}">Delete</button>
                                </div>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>


<!-- Add Contact Modal -->
<div class="modal fade" id="addContactModal" tabindex="-1" role="dialog" aria-labelledby="addContactModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addContactModalLabel">Add Contact</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="post" enctype="multipart/form-data" action="{% url 'add_contact' %}">
                    {% csrf_token %}
                    
                    {{ form.as_p }}

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- Edit Contact Modal -->
{% for contact in contacts %}
    <div class="modal fade" id="editContactModal {{ contact.id }}" tabindex="-1" role="dialog" aria-labelledby="editContactModalLabel {{ contact.id }}" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editContactModalLabel">Edit Contact</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post">
                        {% csrf_token %}
                        {{ form|crispy }}
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>
{% endfor %}

<!-- Delete Contact Modal -->
{% for contact in contacts %}
    <div class="modal fade" id="deleteContactModal {{ contact.id }}" tabindex="-1" role="dialog" aria-labelledby="deleteContactModalLabel {{ contact.id }}" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteContactModalLabel">Delete Contact</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this contact?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
            </div>
        </div>
    </div>
{% endfor %}

{% endblock %}